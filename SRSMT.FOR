      SUBROUTINE SRSMT(N2,N1,W,WLINE,WRK1,IDIR)
C
C     SMOOTHING OF SURFACE W(N2,N2) USING NF DIGITAL FILTER
C     IDIR=1   SMOOTHING ROWS
C     IDIR=2   SMOOTHING COLUMNS
C
      INTEGER N2,N1,NFP,IDIR
      DOUBLE PRECISION W(N2,N2),WLINE(N2),WRK1(N2),FC
C
      NFP=5
      FC=0.11
C
      GO TO (1,2) IDIR
C
C     SMOOTHING ROWS
1     DO 100 I=1,N1
	    DO 200 J=1,N1
		  WLINE(J)=W(I,J)
200	    CONTINUE
	    CALL SFLTR(N1,WLINE,WRK1,NFP,FC)
	    DO 300 J=1,N1
		  W(I,J)=WLINE(J)
300	    CONTINUE
100   CONTINUE
      RETURN
C
C     SMOOTHING COLUMNS
2     DO 400 J=1,N1
	    DO 500 I=1,N1
		  WLINE(I)=W(I,J)
500	    CONTINUE
	    CALL SFLTR(N1,WLINE,WRK1,NFP,FC)
	    DO 600 I=1,N1
		  W(I,J)=WLINE(I)
600	    CONTINUE
400   CONTINUE
      RETURN
C
      END
